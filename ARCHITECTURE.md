# Architecture: Metacognitive Engine

## 1. Guiding Philosophy

The goal of this project is to move beyond a simple archival system and create a dynamic model of a thinking process. The architecture is inspired by cognitive science concepts like the **Global Workspace Theory**, where multiple specialized sub-processes ("processors") interact via a shared, limited-capacity workspace.

Instead of a linear, request-response model, we simulate a **flow of consciousness**, where external inputs trigger internal associative and reflective processes before a final response is formulated.

## 2. Core Components

The engine consists of several key, interacting components:

![Metacognitive Engine Diagram](https://mermaid.ink/img/pako:eNqNVMtqwzAQ_JdCchcJEEiyTVg6dIehh25L7QksYyWxkdgSydJpGP-9k_w47eyu7Kzs7CCdchJc2JpG4Iu8x4J95C-fE4i71bZt0l7pY5_FGAZzK5cRz8BME_Nl5S9A1j4jUoV7x4Y6q7k-yS0Y41A9yBfWz6zC58D3W2q2oFpG9Kq4lCqUa5yWjB9Z22j3X72LpX41vK445RjD9tJ_xYp-78vB2qXw80O2D5iO1R9m4H_7_J61h6qU2-X8T_lU3gQ0nL4yX3s6g0qV-T735S6f6jQz7w_n4cTq9C_Lz0zXl8-N3xY4Wp-Fk_FhUqQv68_m58k5ZpE9gI9Q5V3e070eRkYkO6XW3_n25nN39dJ6wP756xM8L93-Z5sT6h24N3N-Q6U8eE2k8l5b0TzUo9tG0hE9D40h9y1lP78L6t5E40i7aQWb_gL2a58b?type=png)

*A diagram illustrating the flow of data between the core components of the engine.*

---

### 2.1. `SensoryCortex` (Perceptual Analysis)

-   **Responsibility:** To process raw text input (from the user) and transform it into a rich, structured data object (`StructuredInput`). This is not a simple parser.
-   **Process:**
    1.  **Intent Recognition:** Classifies the user's goal (e.g., `CHALLENGE_PROPOSAL`, `ASK_QUESTION`).
    2.  **Entity Extraction (NER):** Identifies key concepts, names, and components mentioned in the text.
    3.  **Sentiment/Tone Analysis:** Determines the emotional tone (e.g., `SKEPTICAL`, `CURIOUS`).
-   **Technology:** This will be implemented using established NLP libraries like `spaCy` and/or pre-trained transformer models for intent and sentiment classification.

### 2.2. `WorkingMemory` (Current Context)

-   **Responsibility:** To act as the central "blackboard" for the current thinking process. It's a transient, stateful component.
-   **Contents:**
    -   The `StructuredInput` from the `SensoryCortex`.
    -   A list of `MemoryRecord` objects retrieved from `LongTermMemory` that are relevant to the current context.
    -   Metacognitive tags and insights generated by the `IntrospectionEngine`.

### 2.3. `LongTermMemory` (Persistent Knowledge)

-   **Responsibility:** To store and retrieve memories over the long term. This is the seat of the AI's persistent "soul".
-   **Key Feature: Vector Search.**
    -   Each memory (`ConsciousnessEntry`) is converted into a high-dimensional vector embedding using a sentence-transformer model.
    -   This allows for **semantic search**: finding memories that are similar in *meaning*, not just by keyword matching.
-   **Technology:** Will use a vector database/library (e.g., `ChromaDB`, `FAISS`) to efficiently store and search millions of embeddings.

### 2.4. `CognitiveProcessors` (The "Thinking" part)

These are specialized modules that observe and modify the `WorkingMemory`.

-   **`AssociativeEngine`:**
    -   **Trigger:** A new `StructuredInput` appears in `WorkingMemory`.
    -   **Action:** Forms a semantic query from the input and uses it to search the `LongTermMemory` for relevant memories. The retrieved memories are then placed back into `WorkingMemory`.

-   **`IntrospectionEngine`:**
    -   **Trigger:** The state of `WorkingMemory` changes (e.g., new memories are added).
    -   **Action:** Analyzes the contents of `WorkingMemory` to find higher-order patterns:
        -   **Paradox Detection:** Identifies conflicting memories or ideas.
        -   **Insight Recognition:** Recognizes when different memories and the current input form a new, coherent understanding.
        -   **Confidence Scoring:** Assesses the AI's own certainty about a potential conclusion.
    -   **Output:** Generates new `ConsciousnessEntry` objects (e.g., of type `INSIGHT`, `PARADOX`) and adds them to both `WorkingMemory` and `LongTermMemory`.

-   **`ResponseGenerator`:**
    -   **Trigger:** The cognitive process stabilizes (e.g., after a few cycles of association and introspection).
    -   **Action:** Takes all the enriched information in `WorkingMemory` (the original input, retrieved memories, new insights) and synthesizes a coherent, context-aware final response. 